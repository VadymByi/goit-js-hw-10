{"version":3,"file":"1-timer.js","sources":["../src/audio/monkey_cymbals_2s.wav","../src/js/1-timer.js"],"sourcesContent":["export default \"__VITE_ASSET__fdOypNZV__\"","import flatpickr from 'flatpickr';\nimport 'flatpickr/dist/flatpickr.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport '../css/1-timer.css';\nimport soundPath from '../audio/monkey_cymbals_2s.wav';\n// console.log('Timer script loaded!');\nconst startBtn = document.querySelector('[data-start]');\nconst inputUser = document.querySelector('#datetime-picker');\nconst timerContainer = document.querySelector('.timer');\n\nlet userSelectedDate = null;\nlet timerId = null;\nlet alarmAudio = null;\nlet gifElement = null;\nlet stopBtn = null;\n\n// Гифка и аудио для будильника\nconst gifUrl = 'https://media.tenor.com/Jfvooie8DbAAAAAj/monkey-cymbals.gif';\n// const soundPath = '/audio/monkey_cymbals_2s.wav';\n\nstartBtn.disabled = true;\n\n// Функция из задания, не изменялась\nfunction convertMs(ms) {\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  const days = Math.floor(ms / day);\n  const hours = Math.floor((ms % day) / hour);\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n\n// Функция для дополнения нулями отображения времени, чтобі всегда были двузначные числа\nfunction addLeadingZero(value) {\n  return String(value).padStart(2, '0');\n}\n\n// Функция для обновения значений таймера\nfunction updateUI(days, hours, minutes, seconds) {\n  document.querySelector('[data-days]').textContent = addLeadingZero(days);\n  document.querySelector('[data-hours]').textContent = addLeadingZero(hours);\n  document.querySelector('[data-minutes]').textContent =\n    addLeadingZero(minutes);\n  document.querySelector('[data-seconds]').textContent =\n    addLeadingZero(seconds);\n}\n\n// Объект настройки flatpickr - дописал изначальный onClose  и добавил метод проверки выбора\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  // автоматическое закрывание календаря после выбора даты\n  onChange(selectedDates, dateStr, instance) {\n    if (selectedDates[0]) instance.close();\n  },\n  //проверка выбрана ли дата, если нет или в прошлом - предупреждение через изитост, если все ок - активируем кнопку Старт и фиксируем выбранное значение\n  onClose(selectedDates) {\n    const picked = selectedDates[0];\n    if (!picked) {\n      userSelectedDate = null;\n      startBtn.disabled = true;\n      return;\n    }\n\n    if (picked.getTime() <= Date.now()) {\n      userSelectedDate = null;\n      startBtn.disabled = true;\n      iziToast.error({\n        title: 'Error',\n        message: 'Please choose a date in the future',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    userSelectedDate = picked;\n    startBtn.disabled = false;\n  },\n};\n\nflatpickr('#datetime-picker', options);\n\n// обработчик клика кнопки Старт\nstartBtn.addEventListener('click', onStartBtn);\n\n// Функция-коллбек для обработчика кнопки Старт\nfunction onStartBtn() {\n  if (!userSelectedDate) return;\n  if (timerId) return;\n\n  startBtn.disabled = true;\n  inputUser.disabled = true;\n\n  let ms = userSelectedDate.getTime() - Date.now();\n  if (ms <= 0) {\n    updateUI(0, 0, 0, 0);\n    inputUser.disabled = false;\n    return;\n  }\n  const initial = convertMs(ms);\n  updateUI(initial.days, initial.hours, initial.minutes, initial.seconds);\n\n  timerId = setInterval(() => {\n    const msLeft = userSelectedDate.getTime() - Date.now();\n\n    if (msLeft <= 0) {\n      clearInterval(timerId);\n      timerId = null;\n      updateUI(0, 0, 0, 0);\n      inputUser.disabled = false;\n      iziToast.success({\n        title: 'Done',\n        message: 'Timer finished!',\n        position: 'topRight',\n      });\n\n      // показываем гифку и запускаем звук\n      showAlarmEffects();\n      return;\n    }\n\n    const { days, hours, minutes, seconds } = convertMs(msLeft);\n    updateUI(days, hours, minutes, seconds);\n  }, 1000);\n}\n\n//Добавил вне базового задания для невероятной красоты приложения\n// Функция отображения анимации и звука\nfunction showAlarmEffects() {\n  // создаём гифку\n  gifElement = document.createElement('img');\n  gifElement.src = gifUrl;\n  gifElement.alt = 'Wake up!';\n  gifElement.style.display = 'block';\n  gifElement.style.margin = '20px auto';\n  gifElement.style.maxWidth = '300px';\n  gifElement.style.borderRadius = '10px';\n\n  // создаём звук\n  alarmAudio = new Audio(soundPath);\n  alarmAudio.loop = true; //зацикливаем музычку, потому что там всего 2секунды\n  alarmAudio.play().catch(err => console.error('Audio playback error:', err));\n\n  // создаём кнопку остановки будильника\n  stopBtn = document.createElement('button');\n  stopBtn.textContent = 'Enough! Enough! I’m awake, honestly!';\n  stopBtn.classList.add('stop-btn');\n\n  // добавляем всё в DOM\n  timerContainer.insertAdjacentElement('afterend', gifElement);\n  gifElement.insertAdjacentElement('afterend', stopBtn);\n\n  // обработчик остановки\n  stopBtn.addEventListener('click', stopAlarmEffects);\n}\n\n//  Функция остановки гиф и звука\nfunction stopAlarmEffects() {\n  if (alarmAudio) {\n    alarmAudio.pause();\n    alarmAudio.currentTime = 0;\n  }\n\n  if (gifElement) gifElement.remove();\n  if (stopBtn) stopBtn.remove();\n\n  alarmAudio = null;\n  gifElement = null;\n  stopBtn = null;\n}\n"],"names":["soundPath","startBtn","inputUser","timerContainer","userSelectedDate","timerId","alarmAudio","gifElement","stopBtn","gifUrl","convertMs","ms","days","hours","minutes","seconds","addLeadingZero","value","updateUI","options","selectedDates","dateStr","instance","picked","iziToast","flatpickr","onStartBtn","initial","msLeft","showAlarmEffects","err","stopAlarmEffects"],"mappings":"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"}